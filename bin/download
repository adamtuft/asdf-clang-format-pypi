#!/usr/bin/env bash

set -euo pipefail

current_script_path=${BASH_SOURCE[0]}
plugin_dir=$(dirname "$(dirname "$current_script_path")")

# shellcheck source=./lib/utils.bash
source "${plugin_dir}/lib/utils.bash"

main() {
	local install_type="$1"
	local version="$2"
	local download_path="${3}"
	if [ "$install_type" != "version" ]; then
		fail "asdf-clang-format supports release installs only"
	fi
	printf "Downloading clang-format version %s to %s\n" "$version" "$download_path"
	if ! python3 -m pip download clang-format=="$version" --no-deps --only-binary clang-format --dest "$download_path"; then
		fail "could not download clang-format version $version"
	fi
}

coalesce_install_version
main "$ASDF_INSTALL_TYPE" "$ASDF_INSTALL_VERSION" "$ASDF_DOWNLOAD_PATH"
